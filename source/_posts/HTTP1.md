HTTP1



HTTP1的演进过程



1991年提出了HTTP/0.9,它也是基于TCP协议的，所以一个HTTP/0.9请求在TCP连接成功后从客服端向服务端发送一个GET请求行信息，服务端收到请求后会采用ASCII字符流返回对应的HTML文件。文件传输完成后就断开连接。



HTTP/0.9有三个特点

1.只有请求行，没有请求头和请求体。

2.服务器返回的信息没有响应头。

3.服务端返回的文件内容是ASCII字符流。因为传输的只有HTML格式的文件，其用ASCII字节码传输最合适。

HTTP/0.9只适合传输体积小的HTML文件。最开始的HTTP只需要满足学术上交流的基本需求而可以用HTTP/0.9来满足，随着新兴网络的兴起，浏览器中展示的不止有HTML，还有JavaScript、CSS、图片、音频等文件，基于此需求HTTP/1.0诞生了。

HTTP/1.0区别于HTTP/0.9的最大区别就是引入了请求头、响应头，这样就能够传输各种更多的文件采用更多的方法进行更加深入的交流。如下所示的请求头信息：

```
accept: text/html
accept-encoding: gzip, deflate, br
accept-Charset: ISO-8859-1,utf-8
accept-language: zh-CN,zh
```

这四行分别表示

1.客户端需要请求的文件信息是text/html。

2.因为传输文件体积往往会相对较大，所以需要压缩文件进行传输，第二行表示的是客户端期待服务端压缩文件的方式。

3.客户端期待返回的文件编码方式是UTF-8 或者 ISO-8859-1。

4.客户端期待服务端想要中文版本语言页面。

服务端会根据客户端发送的请求头信息进行数据处理，最后返回带有响应头的数据信息，如下所示的响应头信息：

```
content-encoding: br
content-type: text/html; charset=UTF-8
```

表示1.服务端最终采用的压缩方式是br。2.服务端返回的Html文件的编码类型是UTF-8。

除了以上这个HTTP/1.0的重要特性外，还有其他几个新增特性：

1.引入了状态码。

2.提供了Cache机制来减轻服务器压力。

3.请求头中加入了用户代理字段来统计客户端基础信息。

HTTP/1.1是在HTTP/1.0的基础上争对其问题进行一定的修改，主要改进内容如下所示：

1.支持持久连接。

在此之前每进行一次HTTP请求连接都要建立一次TCP连接，这样就会在连续多次HTTP连接中产生一定时间用于TCP连接而造成时间延迟，HTTP/1.1使用持久连接进行改进，即一个TCP连接上可以传输多个HTTP请求，只要浏览器或服务器没有明确断开连接，该TCP连接会一直保持。浏览器为每个域名最多同时维护六个TCP持久连接。

2.HTTP管线化。

HTTP/1.1企图使用管线化的方式来解决由于进行多次请求而由于前方的请求未被处理完成而产生的阻塞问题。具体的方式是整批将请求发送给服务端，不过由于服务端一九需要根据请求顺序来进行回复，所以管线化的方案在后来都被许多浏览器放弃。

3.提供虚拟主机支持。

随着虚拟主机技术的发展实现了一台物理主机绑定了多个虚拟主机，即有多个域名，这些域名都共用同一个IP地址，HTTP/1.1在请求头上增加Host字段来表示当前的域名地址来进行处理。

4.对动态生成的内容提供完美支持。

在HTTP/1.0中，需要在响应头设置完整数据大小，浏览器可以根据设置的大小来接受数据，不过现在越来越多的页面内容都是动态生成的，因此在传输数据之前并不知道最终的数据大小，HTTP/1.1引入了Chunk transfer 机制来解决这个问题。

5.客户端Cookie、安全机制。

诞HTTP/1.1存在对宽带利用率并不理想导致网络传输速度较慢的问题，导致该问题的主要原因如下所示：

1.TCP的慢启动。这是TCP为了减少网络拥塞的一个策略，无法改变。

2.同时开启了多条TCP连接，那么这些连接会竞争固定的宽带。

3.HTTP/1.1对头阻塞问题。

HTTP/2 的思路就是一个域名只使用一个 TCP 长连接来传输数据，这样整个页面资源的下载过程只需要一次慢启动，同时也避免了多个 TCP 连接竞争带宽所带来的问题。

另外HTTP/2采用了多路复用来解决阻塞问题，具体就是给每一个请求一个对应的ID，然后服务器就会根据自己的喜好优先选择先处理和返回哪些内容。

除此之外，HTTP/2还设置了请求优先级，可以在发送请求时，标上该请求的优先级，这样服务器接收到该请求之后就会优先处理优先级高的请求。

服务器推送，之前服务端一直是被动的返回信息，诞生HTTP/2可以主动推送信息。

头部压缩。来提高船速效率。

诞生HTTP/2依旧存在一定的问题，HTTP/2的主要问题是其上的TCP协议导致的，因为TCP协议本就是单连接协议，必然产生很多问题导致阻塞延迟的现象，而HTTP无法改变TCP协议就只能绕过TCP协议。HTTP/3则是采用了基于UDP协议来构造一个新的协议QUIC协议，来实现TCP和UD拥有的一些合理性优势。


